[Unit]
Description=arrowhead-gateway
After=network.target mysql.target arrowhead-serviceregistry-sql.service
Requires=arrowhead-serviceregistry-sql.service

[Service]
WorkingDirectory=/etc/arrowhead/gateway
ExecStart=/usr/bin/java --add-modules java.xml.bind -jar /usr/share/arrowhead/systems/arrowhead-gateway-4.0.jar -d -daemon -tls
ExecStartPost=/bin/bash -c 'sleep 1; while ! grep -m1 "Startup completed." /var/log/arrowhead/gateway.log; do sleep 1; done'
TimeoutStopSec=5
Type=simple
User=arrowhead
Group=arrowhead

[Install]
WantedBy=default.target
